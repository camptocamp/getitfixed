<div tal:repeat="child field.children"
     tal:replace="structure child.render_template(field.widget.item_template)" >
</div>
<?python import json ?>
<script tal:condition="exists: deps">
(function(){
  const dependencies = ${structure: json.dumps(deps)}
  if (!dependencies) return
  const [parent, child] = [0,1].map(
    i => $(`select[name=$${dependencies.fields[i]}]`)
  )
  parent.on('change', () => {
    const options = dependencies.values.filter(v => v.cat == parent.val())
    child.empty().append(
      options.map(o =>`<option value="$${o.id}">$${o.label}</option>`)
    )
  })
  parent.trigger('change')
})()
</script>
